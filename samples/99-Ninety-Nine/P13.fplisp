((lambda (encode-direct)
   (encode-direct (quote (a a a a b c c a a d e e e e))))
 (lambda (e)
   (((lambda (u) (u u)) (lambda (u) (lambda (e c n)
       ((lambda (f)
          (if (eq e nil) (cons (f c n) nil)
          (if (eq (car e) c) ((u u) (cdr e) c (+ n 1))
              (cons (f c n) ((u u) (cdr e) (car e) 1)))))
        (lambda (c n) (if (eq n 1) c ((lambda x x) n c)))))))
    (cdr e) (car e) 1)))

